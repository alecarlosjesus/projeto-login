// ./models/usuario-model.js

import { createClient } from '@supabase/supabase-js';

const supabase = createClient(
  process.env.SUPABASE_URL,
  process.env.SUPABASE_ANON_KEY
);

/**
 * Valida se o usu치rio com email e senha existe na base.
 * Retorna o usu치rio se encontrado, ou null.
 */
export async function validarUsuario(email, senha) {
  const { data, error } = await supabase
    .from('usuarios')   // Acessa a tabela 'usuarios'
    .select('*')        // Seleciona todos os campos
    .eq('email', email) // Filtra pelo campo email
    .eq('senha', senha) // Filtra pelo campo senha
    .single();          // Espera apenas um resultado

  if (error || !data) {
    return null;
  }

  return data;
}

/**
 * Insere um novo usu치rio na tabela 'usuarios'.
 * Espera um objeto contendo email e senha.
 */
export async function inserirUsuario(usuario) {
  const { data, error } = await supabase
    .from('usuarios')   // Acessa a tabela 'usuarios'
    .insert([usuario]);//Insere o objeto no formato de array

  if (error) {
    console.error('Erro ao inserir usu치rio:', error);
    return null;
  }

  return data;
}

